<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NLC PERFORMANCE | Longevity Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --nlc-orange: #ff5f00; /* More vibrant orange */
            --dark-bg: #0a0a0a;
            --panel-bg: #141414;
            --border-color: #262626;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--dark-bg);
            color: #ffffff;
            letter-spacing: -0.01em;
        }

        .brand-font {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .glass-panel {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }

        .input-field {
            background: #1f1f1f;
            border: 1px solid #333;
            color: white;
            transition: all 0.2s ease;
        }

        .input-field:focus {
            border-color: var(--nlc-orange);
            outline: none;
            box-shadow: 0 0 0 1px var(--nlc-orange);
        }

        .btn-nlc {
            background-color: var(--nlc-orange);
            color: #000;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.3s ease;
        }

        .btn-nlc:hover {
            background-color: #ff7a29;
            transform: translateY(-1px);
            box-shadow: 0 4px 25px rgba(255, 95, 0, 0.4);
        }

        .accent-text {
            color: var(--nlc-orange);
        }

        /* Custom Gauge Center Text */
        .gauge-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gauge-value {
            position: absolute;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        /* Subtle grid background */
        .bg-grid {
            background-image: linear-gradient(to right, #1a1a1a 1px, transparent 1px),
                              linear-gradient(to bottom, #1a1a1a 1px, transparent 1px);
            background-size: 40px 40px;
        }
    </style>
</head>

<body class="min-h-screen bg-grid flex flex-col">

    <!-- Navbar -->
    <nav class="border-b border-zinc-800 bg-black/80 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-center md:justify-start">
            <div class="brand-font text-xl font-bold tracking-widest">NLC <span class="accent-text">PERFORMANCE</span></div>
        </div>
    </nav>

    <main class="flex-grow max-w-6xl w-full mx-auto p-6 md:p-12">
        
        <!-- Header Section -->
        <div class="mb-12">
            <h1 class="brand-font text-4xl md:text-5xl font-bold mb-4 italic">Longevity Analytics</h1>
            <p class="text-zinc-400 max-w-2xl text-sm md:text-base leading-relaxed">
                Objective biomarkers for healthspan. We benchmark your performance against age-matched norms to target the <span class="accent-text font-bold">Top 10% (Elite)</span> â€” the gold standard for long-term functional independence.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Sidebar: Input Controls -->
            <div class="lg:col-span-4 space-y-6">
                <div class="glass-panel p-6 space-y-5 border-t-2 border-t-[#ff5f00]">
                    <h2 class="brand-font text-sm text-zinc-500 mb-2">Biometric Input</h2>
                    
                    <div>
                        <label class="block text-[10px] uppercase tracking-widest text-zinc-500 mb-1">Sex</label>
                        <select id="gender" class="input-field w-full p-3 text-sm rounded-sm">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-[10px] uppercase tracking-widest text-zinc-500 mb-1">Age Group</label>
                        <input type="number" id="age" value="45" class="input-field w-full p-3 text-sm rounded-sm">
                    </div>

                    <div>
                        <label class="block text-[10px] uppercase tracking-widest text-zinc-500 mb-1">Grip Strength (kg)</label>
                        <input type="number" id="grip" value="48" class="input-field w-full p-3 text-sm rounded-sm">
                    </div>

                    <div>
                        <label class="block text-[10px] uppercase tracking-widest text-zinc-500 mb-1">VO2 Max (ml/kg/min)</label>
                        <input type="number" id="vo2" value="42" class="input-field w-full p-3 text-sm rounded-sm">
                    </div>

                    <button id="calculate-btn" class="btn-nlc w-full py-4 text-sm mt-4">
                        Analyze Performance
                    </button>
                    
                    <div id="error-message" class="text-orange-500 text-[10px] uppercase hidden"></div>
                </div>

                <div class="p-6 border border-zinc-800 rounded-sm bg-black/40">
                    <h3 class="brand-font text-xs text-zinc-400 mb-2 italic">Why these metrics?</h3>
                    <p class="text-[11px] text-zinc-500 leading-normal">
                        Peter Attia identifies VO2 Max and Muscle Strength (proxied by Grip) as the two highest predictors of all-cause mortality. High performance in these categories correlates to a 3x-5x reduction in mortality risk.
                    </p>
                </div>
            </div>

            <!-- Main: Visualization -->
            <div class="lg:col-span-8 space-y-8">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Grip Gauge -->
                    <div class="glass-panel p-8 flex flex-col items-center">
                        <span class="brand-font text-xs text-zinc-500 mb-6 tracking-widest">Grip Strength Efficiency</span>
                        <div class="gauge-container w-full max-w-[240px]">
                            <canvas id="gripGauge"></canvas>
                            <div class="gauge-value">
                                <span id="grip-percentile" class="text-5xl font-bold tracking-tighter">0</span>
                                <div class="text-[10px] uppercase text-zinc-500 tracking-widest mt-1">Percentile</div>
                            </div>
                        </div>
                        <div id="grip-summary" class="mt-6 text-[11px] uppercase tracking-widest font-bold accent-text">--</div>
                    </div>

                    <!-- VO2 Gauge -->
                    <div class="glass-panel p-8 flex flex-col items-center">
                        <span class="brand-font text-xs text-zinc-500 mb-6 tracking-widest">Aerobic Capacity (VO2)</span>
                        <div class="gauge-container w-full max-w-[240px]">
                            <canvas id="vo2Gauge"></canvas>
                            <div class="gauge-value">
                                <span id="vo2-percentile" class="text-5xl font-bold tracking-tighter">0</span>
                                <div class="text-[10px] uppercase text-zinc-500 tracking-widest mt-1">Percentile</div>
                            </div>
                        </div>
                        <div id="vo2-summary" class="mt-6 text-[11px] uppercase tracking-widest font-bold accent-text">--</div>
                    </div>
                </div>

                <!-- Performance Goals -->
                <div id="goal-section" class="glass-panel border-l-4 border-l-[#ff5f00] p-8">
                    <div class="flex items-center space-x-3 mb-6">
                        <div class="h-2 w-2 bg-[#ff5f00]"></div>
                        <h3 class="brand-font text-xl italic">The "Elite" Decile Target</h3>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                        <div>
                            <span class="text-[10px] uppercase tracking-[0.2em] text-zinc-500 block mb-2">Grip Strength Goal</span>
                            <div class="flex items-baseline space-x-2">
                                <span id="grip-goal" class="text-3xl font-bold">--</span>
                                <span class="text-zinc-500 text-xs">kg</span>
                            </div>
                            <div class="w-full bg-zinc-800 h-[2px] mt-4 overflow-hidden">
                                <div id="grip-progress" class="bg-[#ff5f00] h-full transition-all duration-1000" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <span class="text-[10px] uppercase tracking-[0.2em] text-zinc-500 block mb-2">VO2 Max Goal</span>
                            <div class="flex items-baseline space-x-2">
                                <span id="vo2-goal" class="text-3xl font-bold">--</span>
                                <span class="text-zinc-500 text-xs">ml/kg/min</span>
                            </div>
                            <div class="w-full bg-zinc-800 h-[2px] mt-4 overflow-hidden">
                                <div id="vo2-progress" class="bg-[#ff5f00] h-full transition-all duration-1000" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="p-8 border-t border-zinc-900 text-center">
        <p class="text-[10px] uppercase tracking-widest text-zinc-600">
            NLC Performance &copy; 2024 | Adapt. Recover. Master.
        </p>
    </footer>

    <script>
        const vo2MaxData = {
            female: {
                "20-29": { 40: 36.1, 60: 39.5, 80: 43.9, 95: 49.6 },
                "30-39": { 40: 34.4, 60: 37.8, 80: 42.4, 95: 47.4 },
                "40-49": { 40: 33.0, 60: 36.3, 80: 39.7, 95: 45.3 },
                "50-59": { 40: 30.1, 60: 33.0, 80: 36.7, 95: 41.1 },
                "60-69": { 40: 27.5, 60: 30.0, 80: 33.0, 95: 37.8 },
                "70-79": { 40: 25.9, 60: 28.1, 80: 30.9, 95: 36.7 },
            },
            male: {
                "20-29": { 40: 43.0, 60: 46.4, 80: 51.5, 95: 55.9 },
                "30-39": { 40: 40.9, 60: 44.2, 80: 49.4, 95: 54.0 },
                "40-49": { 40: 38.2, 60: 42.0, 80: 47.3, 95: 51.6 },
                "50-59": { 40: 35.5, 60: 39.1, 80: 44.1, 95: 48.0 },
                "60-69": { 40: 32.2, 60: 35.4, 80: 40.3, 95: 44.2 },
                "70-79": { 40: 29.4, 60: 32.3, 80: 36.5, 95: 40.9 },
            }
        };

        const gripStrengthData = {
            female: {
                "20-29": { mean: 30, sd: 7.0 }, "30-39": { mean: 31, sd: 6.4 },
                "40-49": { mean: 29, sd: 5.7 }, "50-59": { mean: 28, sd: 6.3 },
                "60-69": { mean: 24, sd: 5.3 }, "70-79": { mean: 20, sd: 5.8 }
            },
            male: {
                "20-29": { mean: 47, sd: 9.5 }, "30-39": { mean: 47, sd: 9.7 },
                "40-49": { mean: 47, sd: 9.5 }, "50-59": { mean: 45, sd: 8.4 },
                "60-69": { mean: 40, sd: 8.3 }, "70-79": { mean: 33, sd: 7.8 }
            }
        };

        let gripChart, vo2Chart;

        function getAgeBracket(age) {
            if (age < 20) return "20-29";
            if (age >= 20 && age <= 29) return "20-29";
            if (age >= 30 && age <= 39) return "30-39";
            if (age >= 40 && age <= 49) return "40-49";
            if (age >= 50 && age <= 59) return "50-59";
            if (age >= 60 && age <= 69) return "60-69";
            return "70-79";
        }

        function getPercentileFromZ(z) {
            const erf = (x) => {
                const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741, a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;
                const sign = (x >= 0) ? 1 : -1;
                x = Math.abs(x);
                const t = 1.0 / (1.0 + p * x);
                const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
                return sign * y;
            };
            return Math.round(((1.0 + erf(z / Math.sqrt(2))) / 2.0) * 100);
        }

        function calculateVo2Percentile(vo2, gender, bracket) {
            const data = vo2MaxData[gender][bracket];
            const percentiles = Object.keys(data).map(Number);
            const values = Object.values(data);
            if (vo2 < values[0]) return Math.max(1, Math.round((vo2 / values[0]) * 40));
            if (vo2 >= values[3]) return 99;
            for (let i = 0; i < values.length - 1; i++) {
                if (vo2 >= values[i] && vo2 < values[i + 1]) {
                    return Math.round(percentiles[i] + (vo2 - values[i]) * (percentiles[i+1] - percentiles[i]) / (values[i+1] - values[i]));
                }
            }
            return 99;
        }

        function updateGauge(chart, ctxId, percentile) {
            const vibrantOrange = '#ff5f00';
            const color = percentile >= 90 ? vibrantOrange : (percentile >= 50 ? '#ffffff' : '#444');
            const data = {
                datasets: [{
                    data: [percentile, 100 - percentile],
                    backgroundColor: [color, '#1f1f1f'],
                    borderWidth: 0,
                    circumference: 180,
                    rotation: 270,
                    cutout: '88%'
                }]
            };

            if (chart) {
                chart.data = data;
                chart.update();
                return chart;
            } else {
                return new Chart(document.getElementById(ctxId), {
                    type: 'doughnut',
                    data: data,
                    options: { responsive: true, plugins: { tooltip: { enabled: false } }, events: [] }
                });
            }
        }

        function runAnalysis() {
            const gender = document.getElementById('gender').value;
            const age = parseInt(document.getElementById('age').value);
            const grip = parseFloat(document.getElementById('grip').value);
            const vo2 = parseFloat(document.getElementById('vo2').value);
            const bracket = getAgeBracket(age);

            const gData = gripStrengthData[gender][bracket];
            const gPercentile = getPercentileFromZ((grip - gData.mean) / gData.sd);
            const gGoal = (1.282 * gData.sd + gData.mean).toFixed(1);

            const vPercentile = calculateVo2Percentile(vo2, gender, bracket);
            const vData = vo2MaxData[gender][bracket];
            const vGoal = (vData[80] + (90 - 80) * (vData[95] - vData[80]) / (95 - 80)).toFixed(1);

            document.getElementById('grip-percentile').innerText = gPercentile;
            document.getElementById('vo2-percentile').innerText = vPercentile;
            document.getElementById('grip-goal').innerText = gGoal;
            document.getElementById('vo2-goal').innerText = vGoal;
            
            document.getElementById('grip-summary').innerText = gPercentile >= 90 ? "STATUS: ELITE" : "STATUS: SUB-OPTIMAL";
            document.getElementById('vo2-summary').innerText = vPercentile >= 90 ? "STATUS: ELITE" : "STATUS: SUB-OPTIMAL";

            document.getElementById('grip-progress').style.width = Math.min(100, (grip / gGoal) * 100) + '%';
            document.getElementById('vo2-progress').style.width = Math.min(100, (vo2 / vGoal) * 100) + '%';

            gripChart = updateGauge(gripChart, 'gripGauge', gPercentile);
            vo2Chart = updateGauge(vo2Chart, 'vo2Gauge', vPercentile);
        }

        document.getElementById('calculate-btn').addEventListener('click', runAnalysis);
        window.onload = runAnalysis;
    </script>
</body>
</html>
